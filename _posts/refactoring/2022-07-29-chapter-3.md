---
published: false
title: "[리팩토링] Chapter 3. 코드에서 나는 악취"
excerpt: " "
layout: single
author_profile: true
read_time: false
toc: false
toc_label: "My Table of Contents"
toc_icon: "cog"
toc_sticky: true
categories:
  - refactoring

comments: true
header:
  # overlay_image: https://cf.festa.io/img/2019-9-27/a6c0b457-c336-42ba-b06e-462de90ada91.jpg
  # overlay_filter: 0.5
  # teaser: https://cf.festa.io/img/2019-9-27/a6c0b457-c336-42ba-b06e-462de90ada91.jpg
sitemap:
  changefreq: daily
  priority: 1.0
---

## 코드에서 나는 악취

> 냄새 나면 당장 갈아라

코드에서 악취가 난다는 기준은 아래와 같이 정리할수 있다.

### 3.1 기이한 이름

함수, 모듈, 변수, 클래스 등은 그 이름만 보고도 각각이 무슨 일을 하고 어떻게 사용해야 하는지 명확히 알수 있도록 신경 써서 이름을 지어야 한다.

이름에 관련한 리팩터링은 아래와 같다.

- 함수 선언 바꾸기
- 변수 이름 바꾸기
- 필드 이름 바꾸기

### 3.2 중복 코드

중복 코드 관련 리팩터링은 아래와 같다.

- 함수 추출하기
- 문장 슬라이드
- 메서드 올리기 : 같은 부모로부터 파생된 서브 클래스들에 코드가 중복되어 있다면 중복된 코드를 부모의 메서드로 정의하는 것

### 3.3 긴 함수

함수가 길수록 사람들은 함수를 이해하기 힘들다.

긴 함수 관련 리팩터링 작업은 아래와 같다.

- 함수 추출하기 : 99% 는 이 작업을 수행한다.
- 조건문 분해하기 > case 문 마다 `함수 추출하기` > `조건부 로직을 다향성으로 바꾸기`
- 반복문 쪼개기

### 3.4 긴 매개 변수 목록

매개변수 목록이 길어질수록 코드를 이해하기 어렵다.

이와 관련 리팩터링 작업은 아래와 같다.

- 매개 변수를 질의 함수로 바꾸기
- 객체 통째로 넘기기
- 매개변수 객체 만들기
- 여려 함수를 클래스로 묶기

### 3.5 전역 데이터

전역 데이터는 코드베이스 어디에서든 건드를 수 있고 값을 누가 바꿨는지 찾아낼 메커니즘이 없다는 게 문제다.

이와 관련한 리팩터링 작업은 아래와 같다.

- 변수 캡슐화 하기 : 데이터를 수정하는 부분을 쉽게 찾을 수 있고 접근을 통제할수 있게 된다.

### 3.6 가변 데이터

데이터를 변경했더니 예상치 못한 결과나 골치 아픈 버그로 이어지는 경우가 종종 있다. 코드의 다른 곳에서는 다른 값을 기대한다는 사실을 인식하지 못한 채 수정해버리면 프로그램이 오작동을 한다.

이와 관련한 리팩터링 작업은 아래와 같다.

- 변수 캡슐화하기
- 질의 함수와 변경 함수 분리하기
- 세터 제거하기
- 참조를 값으로 바꾸기 : 내부 필드를 직접 수정하지 말고 구조체를 통째로 교체

### 3.7 뒤엉킨 변경

코드를 수정할 때는 시스템에서 고쳐야 할 딱 한 군데를 찾아서 그 부분만 수정할 수 있기를 바란다. 이렇게 할 수 없다면 `뒤엉킨 변경` 과 `산탄총 수술` 중 하나가 풍긴다.

뒤엉킨 변경은 단일 책임 원칙이 제대로 지켜지지 않을 때 나타난다.

이와 관련한 리팩터링 작업은 아래와 같다.

- 단계 쪼개기
- 함수 옮기기
- 함수 추출하기
- 클래스 추출하기

### 3.8 산탄총 수술

산탄총 수술은 뒤엉킨 변경과 비슷하면서도 정반대다.

이 냄새는 코드를 변경할 때마다 자잘하게 수정해야 하는 클래스가 많을 때 풍긴다. 변경할 부분이 코드 전반에 퍼져 있다면 찾기도 어렵고 꼭 수정해야 할 곳을 지나치기 쉽다.

이와 관련한 리팩터링 작업은 아래와 같다.

- 함수 옮기기, 필드 옮기기로 한 모듈에 묶어둔다.
- 여러 함수를 클래스로 묶기
- 어설프게 분리된 로직을 `함수 인라인하기`, `클래스 인라인하기` 를 통해 하나로 묶는다.

## Reference

[리팩터링 2판](http://www.yes24.com/Product/Goods/89649360)
